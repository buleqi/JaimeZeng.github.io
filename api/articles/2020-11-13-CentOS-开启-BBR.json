{"title":"CentOS å¼€å¯ BBR","uid":"af957dc6357d17d5fffb43ddbcdfe97b","slug":"2020-11-13-CentOS-å¼€å¯-BBR","date":"2020-11-13T13:42:36.000Z","updated":"2021-09-06T15:53:22.642Z","comments":true,"path":"api/articles/2020-11-13-CentOS-å¼€å¯-BBR.json","keywords":null,"cover":[],"content":"<p><img src=\"https://img.zxj.guru/2020/11/centos-enable-bbr.png\" alt=\"centos-enable-bbr\"></p>\n<p>Bottleneck Bandwidth and Round-trip propagation timeï¼ˆBBRï¼‰ï¼Œæ˜¯ Google åœ¨ 2016 å¹´å¼€å‘çš„ TCP æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œå¯ä»¥ä½¿ Linux æœåŠ¡å™¨æ˜¾ç€åœ°æé«˜ååé‡å’Œå‡å°‘ TCP è¿æ¥çš„å»¶è¿Ÿã€‚</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>æ³¨æ„ï¼š</p>\n<ol>\n<li><p>ç”±äºæ˜¯ä½¿ç”¨æœ€æ–°ç‰ˆç³»ç»Ÿå†…æ ¸ï¼Œæœ€å¥½è¯·å‹¿åœ¨ç”Ÿäº§ç¯å¢ƒå®‰è£…ï¼Œä»¥å…äº§ç”Ÿä¸å¯é¢„æµ‹ä¹‹åæœã€‚</p>\n</li>\n<li><p>BBR ä¸æ”¯æŒè™šæ‹Ÿæ–¹å¼ä¸º OpenVZ å’Œ LXC çš„æœåŠ¡å™¨ã€‚å¦‚æœä½ çš„æœåŠ¡å™¨ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿”å› <code>openvz</code>, <code>lxc</code> å­—æ®µï¼Œé‚£ä¹ˆä½ å°±æ²¡å¿…è¦ç»§ç»­é˜…è¯»æœ¬æ–‡äº† ğŸ˜‚ã€‚å¦‚æœè¿”å›å…¶å®ƒå­—æ®µï¼ˆä¾‹å¦‚ï¼š<code>kvm</code>, <code>xen</code> , <code>vmware</code> ç­‰ï¼‰ï¼Œé‚£ä¹ˆä½ å¯ä»¥å‚è€ƒä»¥ä¸‹æ­¥éª¤å¼€å¯ BBRã€‚</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">echo $(systemd-detect-virt)\necho $(virt-what)</code></pre></li>\n</ol></blockquote>\n<hr>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>TCP BBRï¼ˆBottleneck Bandwidth and Round-trip propagation timeï¼‰æ˜¯ç”± Google è®¾è®¡ï¼Œäº 2016 å¹´å‘å¸ƒçš„æ‹¥å¡ç®—æ³•ã€‚ä»¥å¾€å¤§éƒ¨åˆ†æ‹¥å¡ç®—æ³•æ˜¯åŸºäºä¸¢åŒ…æ¥ä½œä¸ºé™ä½ä¼ è¾“é€Ÿç‡çš„ä¿¡å·ï¼Œè€Œ BBR åˆ™åŸºäºæ¨¡å‹ä¸»åŠ¨æ¢æµ‹ã€‚è¯¥ç®—æ³•ä½¿ç”¨ç½‘ç»œæœ€è¿‘å‡ºç«™æ•°æ®åˆ†ç»„å½“æ—¶çš„æœ€å¤§å¸¦å®½å’Œå¾€è¿”æ—¶é—´æ¥åˆ›å»ºç½‘ç»œçš„æ˜¾å¼æ¨¡å‹ã€‚æ•°æ®åŒ…ä¼ è¾“çš„æ¯ä¸ªç´¯ç§¯æˆ–é€‰æ‹©æ€§ç¡®è®¤ç”¨äºç”Ÿæˆè®°å½•åœ¨æ•°æ®åŒ…ä¼ è¾“è¿‡ç¨‹å’Œç¡®è®¤è¿”å›æœŸé—´çš„æ—¶é—´å†…æ‰€ä¼ é€æ•°æ®é‡çš„é‡‡æ ·ç‡ã€‚[39]è¯¥ç®—æ³•è®¤ä¸ºéšç€ç½‘ç»œæ¥å£æ§åˆ¶å™¨é€æ¸è¿›å…¥åƒå…†é€Ÿåº¦æ—¶ï¼Œä¸ç¼“å†²è†¨èƒ€ç›¸å…³çš„å»¶è¿Ÿç›¸æ¯”ä¸¢åŒ…æ›´åº”è¯¥è¢«è®¤ä¸ºæ˜¯è¯†åˆ«æ‹¥å¡çš„ä¸»è¦å†³å®šå› ç´ ï¼Œæ‰€ä»¥åŸºäºå»¶è¿Ÿæ¨¡å‹çš„æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼ˆå¦‚ BBRï¼‰ä¼šæœ‰æ›´é«˜çš„ååé‡å’Œæ›´ä½çš„å»¶è¿Ÿï¼Œå¯ä»¥ç”¨ BBR æ¥æ›¿ä»£å…¶ä»–æµè¡Œçš„æ‹¥å¡ç®—æ³•ï¼Œä¾‹å¦‚ CUBICã€‚Google åœ¨ YouTube ä¸Šåº”ç”¨è¯¥ç®—æ³•ï¼Œå°†å…¨çƒå¹³å‡çš„ YouTube ç½‘ç»œååé‡æé«˜äº† 4%ï¼Œåœ¨ä¸€äº›å›½å®¶è¶…è¿‡äº† 14%ã€‚[40]</p>\n<p>BBR ä¹‹åç§»æ¤å…¥ Linux å†…æ ¸ 4.9 ç‰ˆæœ¬ï¼Œ[41][42]å¹¶ä¸”å¯¹äº QUIC å¯ç”¨ã€‚</p>\n<p>BBR æ•ˆç‡å¾ˆé«˜ï¼Œé€Ÿåº¦ä¹Ÿå¾ˆå¿«ï¼Œä½†æ˜¯å®ƒä¸é BBR çš„æµçš„å…¬å¹³æ€§æœ‰äº‰è®®ã€‚è™½ç„¶è°·æ­Œçš„å±•ç¤ºæ˜¾ç¤º BBR ä¸ CUBIC å…±å­˜è‰¯å¥½ï¼Œä½†åƒæ°å¤«Â·ä¼‘æ–¯é¡¿å’Œéœå…‹ã€å¸ƒåˆ©æ–¯å’Œé½ç‰¹å·´ç‰¹ç­‰ç ”ç©¶è€…å‘ç°å®ƒå¯¹å…¶ä»–æµä¸å…¬å¹³ï¼Œå¹¶ä¸”ä¸å¯æ‰©å±•ã€‚[43]éœå…‹ç­‰äººè¿˜å‘ç°ï¼Œåœ¨ Linux 4.9 çš„ BBR å®ç°ä¸­â€å­˜åœ¨ä¸€äº›ä¸¥é‡çš„å›ºæœ‰é—®é¢˜ï¼Œå¦‚æ’é˜Ÿå»¶è¿Ÿå¢åŠ ã€ä¸å…¬å¹³å’Œå¤§é‡æ•°æ®åŒ…ä¸¢å¤±â€ã€‚[44]</p>\n<p>ç´¢æµ·å°”Â·é˜¿å·´æ–¯æ´›ç­‰äºº(C2TCP çš„ä½œè€…)æŒ‡å‡ºï¼ŒBBR åœ¨åŠ¨æ€ç¯å¢ƒä¸­è¡¨ç°ä¸ä½³ï¼Œæ¯”å¦‚èœ‚çªç½‘ç»œã€‚[45][46]ä»–ä»¬è¿˜è¡¨æ˜ BBR å­˜åœ¨ä¸å…¬å¹³é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ª CUBIC æµ(åœ¨ Linuxã€Android å’Œ MacOS ä¸­æ˜¯é»˜è®¤çš„ TCP å®ç°)ä¸ç½‘ç»œä¸­çš„ BBR æµå…±å­˜æ—¶ï¼ŒBBR æµå¯ä»¥æ”¯é… CUBIC æµå¹¶ä»ä¸­è·å¾—æ•´ä¸ªé“¾è·¯å¸¦å®½[45]ã€‚</p>\n<p>â€“ <a href=\"https://zh.wikipedia.org/wiki/TCP%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6#TCP_BBR\">TCP BBR - Wikipedia</a></p></blockquote>\n<h2 id=\"ä¸€é”®è„šæœ¬\"><a href=\"#ä¸€é”®è„šæœ¬\" class=\"headerlink\" title=\"ä¸€é”®è„šæœ¬\"></a>ä¸€é”®è„šæœ¬</h2><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>ä»¥ä¸‹ä¸€é”®è„šæœ¬å†…å®¹è½¬è½½äºï¼š<a href=\"https://teddysun.com/489.html\">ä¸€é”®å®‰è£…æœ€æ–°å†…æ ¸å¹¶å¼€å¯ BBR è„šæœ¬ | ç§‹æ°´é€¸å†°</a></p></blockquote>\n<h3 id=\"æœ¬è„šæœ¬é€‚ç”¨ç¯å¢ƒ\"><a href=\"#æœ¬è„šæœ¬é€‚ç”¨ç¯å¢ƒ\" class=\"headerlink\" title=\"æœ¬è„šæœ¬é€‚ç”¨ç¯å¢ƒ\"></a>æœ¬è„šæœ¬é€‚ç”¨ç¯å¢ƒ</h3><ul>\n<li>ç³»ç»Ÿæ”¯æŒï¼šCentOS 6+ï¼ŒDebian 8+ï¼ŒUbuntu 16+</li>\n<li>è™šæ‹ŸæŠ€æœ¯ï¼šOpenVZ ä»¥å¤–çš„ï¼Œæ¯”å¦‚ KVMã€Xenã€VMware</li>\n<li>å†…å­˜è¦æ±‚ï¼šâ‰¥128M</li>\n<li>æ—¥æœŸã€€ã€€ï¼š2020 å¹´ 9 æœˆ 8 æ—¥</li>\n</ul>\n<h3 id=\"å…³äºæœ¬è„šæœ¬\"><a href=\"#å…³äºæœ¬è„šæœ¬\" class=\"headerlink\" title=\"å…³äºæœ¬è„šæœ¬\"></a>å…³äºæœ¬è„šæœ¬</h3><ol>\n<li>æœ¬è„šæœ¬å·²åœ¨ <strong>Vultr</strong> ä¸Šçš„ VPS å…¨éƒ¨æµ‹è¯•é€šè¿‡ã€‚</li>\n<li>å½“è„šæœ¬æ£€æµ‹åˆ° VPS çš„è™šæ‹Ÿæ–¹å¼ä¸º OpenVZ æ—¶ï¼Œä¼šæç¤ºé”™è¯¯ï¼Œå¹¶è‡ªåŠ¨é€€å‡ºå®‰è£…ã€‚</li>\n<li>è„šæœ¬è¿è¡Œå®Œé‡å¯å‘ç°å¼€ä¸äº†æœºçš„ï¼Œæ‰“å¼€ VPS åå°æ§åˆ¶é¢æ¿çš„ VNC, å¼€æœºå¡åœ¨ grub å¼•å¯¼, æ‰‹åŠ¨é€‰æ‹©å†…æ ¸å³å¯ã€‚</li>\n<li>ç”±äºæ˜¯ä½¿ç”¨æœ€æ–°ç‰ˆç³»ç»Ÿå†…æ ¸ï¼Œæœ€å¥½è¯·å‹¿åœ¨ç”Ÿäº§ç¯å¢ƒå®‰è£…ï¼Œä»¥å…äº§ç”Ÿä¸å¯é¢„æµ‹ä¹‹åæœã€‚</li>\n</ol>\n<h3 id=\"ä½¿ç”¨æ–¹æ³•\"><a href=\"#ä½¿ç”¨æ–¹æ³•\" class=\"headerlink\" title=\"ä½¿ç”¨æ–¹æ³•\"></a>ä½¿ç”¨æ–¹æ³•</h3><p>ä½¿ç”¨ root ç”¨æˆ·ç™»å½•ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">wget --no-check-certificate -O &#x2F;opt&#x2F;bbr.sh https:&#x2F;&#x2F;github.com&#x2F;teddysun&#x2F;across&#x2F;raw&#x2F;master&#x2F;bbr.sh\nchmod 755 &#x2F;opt&#x2F;bbr.sh\n&#x2F;opt&#x2F;bbr.sh</code></pre>\n\n<p>å®‰è£…å®Œæˆåï¼Œè„šæœ¬ä¼šæç¤ºéœ€è¦é‡å¯ VPSï¼Œè¾“å…¥ y å¹¶å›è½¦åé‡å¯ã€‚<br>é‡å¯å®Œæˆåï¼Œè¿›å…¥ VPSï¼ŒéªŒè¯ä¸€ä¸‹æ˜¯å¦æˆåŠŸå®‰è£…æœ€æ–°å†…æ ¸å¹¶å¼€å¯ TCP BBRï¼Œè¾“å…¥ä»¥ä¸‹æ£€æŸ¥ï¼š</p>\n<ol>\n<li><p>æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">uname -r</code></pre>\n\n<p>æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ï¼Œæ˜¾ç¤ºä¸ºæ–°ç‰ˆå†…æ ¸å°±è¡¨ç¤º OK äº†ã€‚</p>\n</li>\n<li><p>éªŒè¯æ˜¯å¦æˆåŠŸå¼€å¯äº† BBRã€‚</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sysctl net.ipv4.tcp_available_congestion_control\n# è¿”å›å€¼ä¸€èˆ¬ä¸ºï¼š\n# net.ipv4.tcp_available_congestion_control &#x3D; bbr cubic reno\n# æˆ–è€…ï¼š\n# net.ipv4.tcp_available_congestion_control &#x3D; reno cubic bbr</code></pre>\n\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sysctl net.ipv4.tcp_congestion_control\n# è¿”å›å€¼ä¸€èˆ¬ä¸ºï¼š\n# net.ipv4.tcp_congestion_control &#x3D; bbr</code></pre>\n\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sysctl net.core.default_qdisc\n# è¿”å›å€¼ä¸€èˆ¬ä¸ºï¼š\n# net.core.default_qdisc &#x3D; fq</code></pre></li>\n<li><p>æŸ¥çœ‹å†…æ ¸æ¨¡å—æ˜¯å¦åŠ è½½ã€‚</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">lsmod | grep bbr</code></pre>\n\n<p>è¿”å›å€¼æœ‰ tcp_bbr æ¨¡å—å³è¯´æ˜ bbr å·²å¯åŠ¨ã€‚æ¯”å¦‚ï¼š</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">tcp_bbr                20480  3</code></pre>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>æ³¨æ„ï¼šå¹¶ä¸æ˜¯æ‰€æœ‰çš„ VPS éƒ½ä¼šæœ‰æ­¤è¿”å›å€¼ï¼Œè‹¥æ²¡æœ‰ä¹Ÿå±æ­£å¸¸ã€‚</p></blockquote>\n</li>\n</ol>\n<h3 id=\"ç‰¹åˆ«è¯´æ˜\"><a href=\"#ç‰¹åˆ«è¯´æ˜\" class=\"headerlink\" title=\"ç‰¹åˆ«è¯´æ˜\"></a>ç‰¹åˆ«è¯´æ˜</h3><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Google Cloud Platform ï¼ˆGCPï¼‰æ›´æ¢å†…æ ¸ï¼Œæœ‰æ—¶ä¼šé‡åˆ°é‡å¯åï¼Œæ•´ä¸ªç£ç›˜å˜ä¸ºåªè¯»çš„æƒ…å†µã€‚åªéœ€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯æ¢å¤ï¼š</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">mount -o remount rw &#x2F;</code></pre>\n\n<h2 id=\"CentOS-7-æ‰‹åŠ¨å¼€å¯\"><a href=\"#CentOS-7-æ‰‹åŠ¨å¼€å¯\" class=\"headerlink\" title=\"CentOS 7 æ‰‹åŠ¨å¼€å¯\"></a>CentOS 7 æ‰‹åŠ¨å¼€å¯</h2><h3 id=\"æ›´æ¢å†…æ ¸\"><a href=\"#æ›´æ¢å†…æ ¸\" class=\"headerlink\" title=\"æ›´æ¢å†…æ ¸\"></a>æ›´æ¢å†…æ ¸</h3><p>ç”±äºå¼€å¯ BBR éœ€ 4.10 ä»¥ä¸Šç‰ˆæœ¬ Linux å†…æ ¸ï¼Œå¦‚æœæ‚¨çš„ Linux æœåŠ¡å™¨å†…æ ¸ä½äº 4.10ï¼ˆä¾‹å¦‚ï¼šè…¾è®¯äº‘æ§åˆ¶å°å®‰è£…çš„ CentOS 7 ç³»ç»Ÿå†…æ ¸æ˜¯ <code>3.10</code>ï¼Œä½äºå¼€å¯ BBR æœ€ä½è¦æ±‚çš„ç‰ˆæœ¬ <code>4.10</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ›´æ¢ä¸ºé»˜è®¤å†…æ ¸åå†ä½œå‡çº§ï¼‰ã€‚</p>\n<p>æ‰‹åŠ¨æ›´æ¢å†…æ ¸çš„æ­¥éª¤å¯ä»¥çœ‹æˆ‘ä¹‹å‰çš„æ–‡ç« ï¼š<a href=\"https://www.zxj.guru/centos-upgrade-kernel.html\">CentOS æ‰‹åŠ¨æ›´æ¢å†…æ ¸</a>ã€‚</p>\n<h3 id=\"å¼€å¯-BBR\"><a href=\"#å¼€å¯-BBR\" class=\"headerlink\" title=\"å¼€å¯ BBR\"></a>å¼€å¯ BBR</h3><ol>\n<li><p>ç¼–è¾‘ <code>/etc/sysctl.conf</code> æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ã€‚</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">net.core.default_qdisc&#x3D;fq\nnet.ipv4.tcp_congestion_control&#x3D;bbr\n#bash\nsudo sed -i &#39;&#x2F;net.core.default_qdisc&#x2F;d&#39; &#x2F;etc&#x2F;sysctl.conf\nsudo sed -i &#39;&#x2F;net.ipv4.tcp_congestion_control&#x2F;d&#39; &#x2F;etc&#x2F;sysctl.conf\nsudo echo &quot;net.core.default_qdisc &#x3D; fq&quot; &gt;&gt; &#x2F;etc&#x2F;sysctl.conf\nsudo echo &quot;net.ipv4.tcp_congestion_control &#x3D; bbr&quot; &gt;&gt; &#x2F;etc&#x2F;sysctl.conf</code></pre></li>\n<li><p>ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½å†…æ ¸å‚æ•°è®¾ç½®ã€‚</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sysctl -p &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1</code></pre></li>\n<li><p>éªŒè¯æ˜¯å¦æˆåŠŸå¼€å¯äº† BBRã€‚</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sysctl net.ipv4.tcp_available_congestion_control | grep -o &#39;net.ipv4.tcp_available_congestion_control &#x3D; reno cubic bbr&#39;\nsysctl net.ipv4.tcp_available_congestion_control | grep -o &#39;net.ipv4.tcp_available_congestion_control &#x3D; bbr cubic reno&#39;\n# é«˜äº®æ˜¾ç¤ºå¦‚ä¸‹ä»»æ„ä¸€æ¡å†…å®¹å³å¯ï¼š\n# net.ipv4.tcp_available_congestion_control &#x3D; reno cubic bbr\n# net.ipv4.tcp_available_congestion_control &#x3D; bbr cubic reno</code></pre>\n\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sysctl net.ipv4.tcp_congestion_control | grep -o &#39;net.ipv4.tcp_congestion_control &#x3D; bbr&#39;\n# é«˜äº®æ˜¾ç¤ºå¦‚ä¸‹å†…å®¹å³å¯ï¼š\n# net.ipv4.tcp_congestion_control &#x3D; bbr</code></pre>\n\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sysctl net.ipv4.tcp_available_congestion_control | grep -o &#39;net.ipv4.tcp_available_congestion_control &#x3D; reno cubic bbr&#39;\n# é«˜äº®æ˜¾ç¤ºå¦‚ä¸‹å†…å®¹å³å¯ï¼š\n# net.ipv4.tcp_available_congestion_control &#x3D; reno cubic bbr</code></pre></li>\n<li><p>æŸ¥çœ‹å†…æ ¸æ¨¡å—æ˜¯å¦åŠ è½½ã€‚</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ lsmod | grep bbr\ntcp_bbr                20480  1</code></pre></li>\n<li><p>æ›´æ”¹æ–‡ä»¶æƒé™ã€‚</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sudo chmod 644 &#x2F;etc&#x2F;sysctl.conf</code></pre></li>\n</ol>\n","text":" Bottleneck Bandwidth and Round-trip propagation timeï¼ˆBBRï¼‰ï¼Œæ˜¯ Google åœ¨ 2016 å¹´å¼€å‘çš„ TCP æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œå¯ä»¥ä½¿ Linux æœåŠ¡å™¨æ˜¾ç€åœ°æé«˜ååé‡å’Œå‡å°‘ TCP è¿æ¥çš„å»¶è¿Ÿã€‚ æ³¨æ„ï¼š ç”±äºæ˜¯ä½¿ç”¨æœ€æ–°ç‰ˆç³»...","link":"","photos":[],"count_time":{"symbolsCount":"4.2k","symbolsTime":"4 mins."},"categories":[{"name":"CentOS","slug":"CentOS","count":4,"path":"api/categories/CentOS.json"}],"tags":[{"name":"CentOS","slug":"CentOS","count":4,"path":"api/tags/CentOS.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%80%E9%94%AE%E8%84%9A%E6%9C%AC\"><span class=\"toc-text\">ä¸€é”®è„šæœ¬</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%9C%AC%E8%84%9A%E6%9C%AC%E9%80%82%E7%94%A8%E7%8E%AF%E5%A2%83\"><span class=\"toc-text\">æœ¬è„šæœ¬é€‚ç”¨ç¯å¢ƒ</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%85%B3%E4%BA%8E%E6%9C%AC%E8%84%9A%E6%9C%AC\"><span class=\"toc-text\">å…³äºæœ¬è„šæœ¬</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">ä½¿ç”¨æ–¹æ³•</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%89%B9%E5%88%AB%E8%AF%B4%E6%98%8E\"><span class=\"toc-text\">ç‰¹åˆ«è¯´æ˜</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#CentOS-7-%E6%89%8B%E5%8A%A8%E5%BC%80%E5%90%AF\"><span class=\"toc-text\">CentOS 7 æ‰‹åŠ¨å¼€å¯</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%9B%B4%E6%8D%A2%E5%86%85%E6%A0%B8\"><span class=\"toc-text\">æ›´æ¢å†…æ ¸</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%BC%80%E5%90%AF-BBR\"><span class=\"toc-text\">å¼€å¯ BBR</span></a></li></ol></li></ol>","author":{"name":"JaimeZeng","slug":"blog-author","avatar":"https://cdn.staticaly.com/gh/JaimeZeng/cdn/main/blog/avatar.png","link":"/","description":"Stay Simple.","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"github":"https://github.com/JaimeZeng"}}},"mapped":true,"prev_post":{"title":"æ³¨å†Œ UCloud ç”¨æˆ·ç¤¾åŒºè·å–ç§¯åˆ†å¯å…‘æ¢ä»£é‡‘åˆ¸å’Œç¤¼å“","uid":"836fbbe66da33f58c140987f7ad616d1","slug":"2020-12-03 æ³¨å†Œ UCloud ç”¨æˆ·ç¤¾åŒºè·å–ç§¯åˆ†å¯å…‘æ¢ä»£é‡‘åˆ¸å’Œç¤¼å“","date":"2020-12-03T09:25:26.000Z","updated":"2021-09-06T15:53:22.642Z","comments":true,"path":"api/articles/2020-12-03 æ³¨å†Œ UCloud ç”¨æˆ·ç¤¾åŒºè·å–ç§¯åˆ†å¯å…‘æ¢ä»£é‡‘åˆ¸å’Œç¤¼å“.json","keywords":null,"cover":[],"text":"2020 å¹´ 1 æœˆï¼ŒUCloud ä¼˜åˆ»å¾—ï¼ˆè‚¡ç¥¨ç®€ç§°ï¼šä¼˜åˆ»å¾—ï¼Œè‚¡ç¥¨ä»£ç ï¼š688158ï¼‰æ­£å¼ç™»é™†ç§‘åˆ›æ¿ï¼Œæˆä¸ºä¸­å›½ç¬¬ä¸€å®¶å…¬æœ‰äº‘ç§‘åˆ›æ¿ä¸Šå¸‚å…¬å¸ï¼ŒåŒæ—¶æˆä¸ºäº†ä¸­å›½ A è‚¡å¸‚åœºé¦–å®¶â€åŒè‚¡ä¸åŒæƒâ€ çš„ä¸Šå¸‚ä¼ä¸šï¼Œå¼€åˆ›äº†ä¸­å›½ A è‚¡èµ„æœ¬å¸‚åœºåŠå…¬å¸æ²»ç†çš„å…ˆæ²³ã€‚ UClub æ˜¯å‰æ®µæ—¶é—´ UCloud ...","link":"","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"æ´»åŠ¨","slug":"æ´»åŠ¨","count":3,"path":"api/categories/æ´»åŠ¨.json"}],"tags":[{"name":"æ´»åŠ¨","slug":"æ´»åŠ¨","count":3,"path":"api/tags/æ´»åŠ¨.json"},{"name":"UCloud","slug":"UCloud","count":3,"path":"api/tags/UCloud.json"}],"author":{"name":"JaimeZeng","slug":"blog-author","avatar":"https://cdn.staticaly.com/gh/JaimeZeng/cdn/main/blog/avatar.png","link":"/","description":"Stay Simple.","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"github":"https://github.com/JaimeZeng"}}}},"next_post":{"title":"CentOS æ‰‹åŠ¨æ›´æ¢å†…æ ¸","uid":"64736f77b89e86715a6b7061bf24c0ba","slug":"2020-11-13-CentOS-æ‰‹åŠ¨æ›´æ¢å†…æ ¸","date":"2020-11-13T13:26:07.000Z","updated":"2021-09-06T15:53:22.642Z","comments":true,"path":"api/articles/2020-11-13-CentOS-æ‰‹åŠ¨æ›´æ¢å†…æ ¸.json","keywords":null,"cover":[],"text":" ç”±äºå¼€å¯ BBR éœ€ 4.10 ä»¥ä¸Šç‰ˆæœ¬ Linux å†…æ ¸ï¼Œ ä½†æ˜¯äº‘æœåŠ¡å™¨å®‰è£…çš„ CentOS 7 ç³»ç»Ÿå†…æ ¸æ˜¯ 3.10ï¼Œä½äºå¼€å¯ BBR æœ€ä½è¦æ±‚çš„ç‰ˆæœ¬ 4.10ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ›´æ¢ä¸ºé»˜è®¤å†…æ ¸åå†ä½œå‡çº§ã€‚ ç”±äºæ˜¯ä½¿ç”¨æœ€æ–°ç‰ˆç³»ç»Ÿå†…æ ¸ï¼Œæœ€å¥½è¯·å‹¿åœ¨ç”Ÿäº§ç¯å¢ƒå®‰è£…ï¼Œä»¥å…äº§ç”Ÿä¸å¯é¢„æµ‹ä¹‹...","link":"","photos":[],"count_time":{"symbolsCount":"2k","symbolsTime":"2 mins."},"categories":[{"name":"CentOS","slug":"CentOS","count":4,"path":"api/categories/CentOS.json"}],"tags":[{"name":"CentOS","slug":"CentOS","count":4,"path":"api/tags/CentOS.json"},{"name":"Kernel","slug":"Kernel","count":1,"path":"api/tags/Kernel.json"}],"author":{"name":"JaimeZeng","slug":"blog-author","avatar":"https://cdn.staticaly.com/gh/JaimeZeng/cdn/main/blog/avatar.png","link":"/","description":"Stay Simple.","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"github":"https://github.com/JaimeZeng"}}}}}