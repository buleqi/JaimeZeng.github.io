{"title":"CentOS 7 升级 gcc","uid":"92309251cf261dbf3ee26b874b03ce39","slug":"2020-08-01-CentOS-7-升级-gcc","date":"2020-08-01T12:33:16.000Z","updated":"2021-09-02T13:46:03.511Z","comments":true,"path":"api/articles/2020-08-01-CentOS-7-升级-gcc.json","keywords":null,"cover":null,"content":"<p>Centos7 gcc 版本默认 4.8.5，而有些软件（例如：Redis6、Mariadb10 等）的编译安装需要最低支持 c++11 的 gcc 5.x 版本。我们在需要升级 gcc 的版本。但是 Red Hat 为了软件的稳定和版本支持，yum 上版本也是 4.8.5，所以无法使用 yum 进行软件更新，需要安装 SCL 源升级 gcc。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ gcc -v\ngcc version 4.8.5 20150623 (Red Hat 4.8.5-44) (GCC)</code></pre>\n\n<h2 id=\"安装-SCL-源\"><a href=\"#安装-SCL-源\" class=\"headerlink\" title=\"安装 SCL 源\"></a>安装 SCL 源</h2><p>SCL 软件集(Software Collections),是为了给 RHEL/CentOS 用户提供一种以方便、安全地安装和使用应用程序和运行时环境的多个（而且可能是更新的）版本的方式，同时避免把系统搞乱。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">yum install -y centos-release-scl scl-utils-build</code></pre>\n\n<h2 id=\"更换国内镜像源\"><a href=\"#更换国内镜像源\" class=\"headerlink\" title=\"更换国内镜像源\"></a>更换国内镜像源</h2><p>执行替换命令将软件仓库地址替换为国内镜像地址。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"># 清华大学\nsed -i &#39;s+#baseurl&#x3D;http:&#x2F;&#x2F;mirror.centos.org+baseurl&#x3D;https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl-rh.repo\nsed -i &#39;s+mirrorlist&#x3D;+#mirrorlist&#x3D;+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl-rh.repo\nsed -i &#39;s+# baseurl&#x3D;http:&#x2F;&#x2F;mirror.centos.org+baseurl&#x3D;https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl.repo\nsed -i &#39;s+mirrorlist&#x3D;+#mirrorlist&#x3D;+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl.repo\n\n# 阿里云\nsed -i &#39;s+#baseurl&#x3D;http:&#x2F;&#x2F;mirror.centos.org+baseurl&#x3D;https:&#x2F;&#x2F;mirrors.aliyun.com+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl-rh.repo\nsed -i &#39;s+mirrorlist&#x3D;+#mirrorlist&#x3D;+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl-rh.repo\nsed -i &#39;s+# baseurl&#x3D;http:&#x2F;&#x2F;mirror.centos.org+baseurl&#x3D;https:&#x2F;&#x2F;mirrors.aliyun.com+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl.repo\nsed -i &#39;s+mirrorlist&#x3D;+#mirrorlist&#x3D;+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl.repo\n\n# 腾讯云\nsed -i &#39;s+#baseurl&#x3D;http:&#x2F;&#x2F;mirror.centos.org+baseurl&#x3D;https:&#x2F;&#x2F;mirrors.cloud.tencent.com+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl-rh.repo\nsed -i &#39;s+mirrorlist&#x3D;+#mirrorlist&#x3D;+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl-rh.repo\nsed -i &#39;s+# baseurl&#x3D;http:&#x2F;&#x2F;mirror.centos.org+baseurl&#x3D;https:&#x2F;&#x2F;mirrors.cloud.tencent.com+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl.repo\nsed -i &#39;s+mirrorlist&#x3D;+#mirrorlist&#x3D;+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl.repo\n\n# 腾讯云内网\nsed -i &#39;s+#baseurl&#x3D;http:&#x2F;&#x2F;mirror.centos.org+baseurl&#x3D;https:&#x2F;&#x2F;&#x2F;mirrors.tencentyun.com+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl-rh.repo\nsed -i &#39;s+mirrorlist&#x3D;+#mirrorlist&#x3D;+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl-rh.repo\nsed -i &#39;s+# baseurl&#x3D;http:&#x2F;&#x2F;mirror.centos.org+baseurl&#x3D;https:&#x2F;&#x2F;&#x2F;mirrors.tencentyun.com+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl.repo\nsed -i &#39;s+mirrorlist&#x3D;+#mirrorlist&#x3D;+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl.repo\n\n# 阿里云内网\nsed -i &#39;s+#baseurl&#x3D;http:&#x2F;&#x2F;mirror.centos.org+baseurl&#x3D;https:&#x2F;&#x2F;mirrors.cloud.aliyuncs.com+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl-rh.repo\nsed -i &#39;s+mirrorlist&#x3D;+#mirrorlist&#x3D;+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl-rh.repo\nsed -i &#39;s+# baseurl&#x3D;http:&#x2F;&#x2F;mirror.centos.org+baseurl&#x3D;https:&#x2F;&#x2F;mirrors.cloud.aliyuncs.com+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl.repo\nsed -i &#39;s+mirrorlist&#x3D;+#mirrorlist&#x3D;+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-SCLo-scl.repo</code></pre>\n\n<p>替换后的文件内容如下。</p>\n<pre class=\"line-numbers language-ini\" data-language=\"ini\"><code class=\"language-ini\"># CentOS-SCLo-sclo.repo\n#\n# Please see http:&#x2F;&#x2F;wiki.centos.org&#x2F;SpecialInterestGroup&#x2F;SCLo for more\n# information\n\n[centos-sclo-sclo]\nname&#x3D;CentOS-7 - SCLo sclo\nbaseurl&#x3D;https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;centos&#x2F;7&#x2F;sclo&#x2F;$basearch&#x2F;sclo&#x2F;\n#mirrorlist&#x3D;http:&#x2F;&#x2F;mirrorlist.centos.org?arch&#x3D;$basearch&amp;release&#x3D;7&amp;repo&#x3D;sclo-sclo\ngpgcheck&#x3D;1\nenabled&#x3D;1\ngpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-SIG-SCLo\n\n[centos-sclo-sclo-testing]\nname&#x3D;CentOS-7 - SCLo sclo Testing\nbaseurl&#x3D;http:&#x2F;&#x2F;buildlogs.centos.org&#x2F;centos&#x2F;7&#x2F;sclo&#x2F;$basearch&#x2F;sclo&#x2F;\ngpgcheck&#x3D;0\nenabled&#x3D;0\ngpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-SIG-SCLo\n\n[centos-sclo-sclo-source]\nname&#x3D;CentOS-7 - SCLo sclo Sources\nbaseurl&#x3D;http:&#x2F;&#x2F;vault.centos.org&#x2F;centos&#x2F;7&#x2F;sclo&#x2F;Source&#x2F;sclo&#x2F;\ngpgcheck&#x3D;1\nenabled&#x3D;0\ngpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-SIG-SCLo\n\n[centos-sclo-sclo-debuginfo]\nname&#x3D;CentOS-7 - SCLo sclo Debuginfo\nbaseurl&#x3D;http:&#x2F;&#x2F;debuginfo.centos.org&#x2F;centos&#x2F;7&#x2F;sclo&#x2F;$basearch&#x2F;\ngpgcheck&#x3D;1\nenabled&#x3D;0\ngpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-SIG-SCLo</code></pre>\n\n<pre class=\"line-numbers language-ini\" data-language=\"ini\"><code class=\"language-ini\"># CentOS-SCLo-sclo.repo\n#\n# Please see http:&#x2F;&#x2F;wiki.centos.org&#x2F;SpecialInterestGroup&#x2F;SCLo for more\n# information\n\n[centos-sclo-sclo]\nname&#x3D;CentOS-7 - SCLo sclo\n# baseurl&#x3D;http:&#x2F;&#x2F;mirror.centos.org&#x2F;centos&#x2F;7&#x2F;sclo&#x2F;$basearch&#x2F;sclo&#x2F;\nmirrorlist&#x3D;http:&#x2F;&#x2F;mirrorlist.centos.org?arch&#x3D;$basearch&amp;release&#x3D;7&amp;repo&#x3D;sclo-sclo\ngpgcheck&#x3D;1\nenabled&#x3D;1\ngpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-SIG-SCLo\n\n[centos-sclo-sclo-testing]\nname&#x3D;CentOS-7 - SCLo sclo Testing\nbaseurl&#x3D;http:&#x2F;&#x2F;buildlogs.centos.org&#x2F;centos&#x2F;7&#x2F;sclo&#x2F;$basearch&#x2F;sclo&#x2F;\ngpgcheck&#x3D;0\nenabled&#x3D;0\ngpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-SIG-SCLo\n\n[centos-sclo-sclo-source]\nname&#x3D;CentOS-7 - SCLo sclo Sources\nbaseurl&#x3D;http:&#x2F;&#x2F;vault.centos.org&#x2F;centos&#x2F;7&#x2F;sclo&#x2F;Source&#x2F;sclo&#x2F;\ngpgcheck&#x3D;1\nenabled&#x3D;0\ngpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-SIG-SCLo\n\n[centos-sclo-sclo-debuginfo]\nname&#x3D;CentOS-7 - SCLo sclo Debuginfo\nbaseurl&#x3D;http:&#x2F;&#x2F;debuginfo.centos.org&#x2F;centos&#x2F;7&#x2F;sclo&#x2F;$basearch&#x2F;\ngpgcheck&#x3D;1\nenabled&#x3D;0\ngpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-SIG-SCLo</code></pre>\n\n<h2 id=\"更新软件包缓存\"><a href=\"#更新软件包缓存\" class=\"headerlink\" title=\"更新软件包缓存\"></a>更新软件包缓存</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">yum makecache fast</code></pre>\n\n<h2 id=\"查看源中关于-devtoolset-gcc-的软件包\"><a href=\"#查看源中关于-devtoolset-gcc-的软件包\" class=\"headerlink\" title=\"查看源中关于 devtoolset-gcc 的软件包\"></a>查看源中关于 devtoolset-gcc 的软件包</h2><p>devtoolset (Developer Toolset)是按照 Software Collections 的规范打出来的一套 rpm 包，提供了最新版本的 GNU 编译器集合，GNU 调试器以及其他开发，调试和性能监视工具。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"># yum list all --enablerepo&#x3D;&#39;centos-sclo-rh&#39; | grep devtoolset-9-gcc\nRepository epel is listed more than once in the configuration\ndevtoolset-9-gcc.x86_64                    9.3.1-2.el7            centos-sclo-rh\ndevtoolset-9-gcc-c++.x86_64                9.3.1-2.el7            centos-sclo-rh\ndevtoolset-9-gcc-gdb-plugin.x86_64         9.3.1-2.el7            centos-sclo-rh\ndevtoolset-9-gcc-gfortran.x86_64           9.3.1-2.el7            centos-sclo-rh\ndevtoolset-9-gcc-plugin-devel.x86_64       9.3.1-2.el7            centos-sclo-rh</code></pre>\n\n<h2 id=\"安装软件包\"><a href=\"#安装软件包\" class=\"headerlink\" title=\"安装软件包\"></a>安装软件包</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">yum install -y devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils</code></pre>\n\n<h2 id=\"切换-gcc-版本\"><a href=\"#切换-gcc-版本\" class=\"headerlink\" title=\"切换 gcc 版本\"></a>切换 gcc 版本</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">&#x2F;&#x2F; 临时有效，退出 shell 或重启会恢复原 gcc 版本\nscl enable devtoolset-9 bash\n\n&#x2F;&#x2F; 长期有效\necho &quot;source &#x2F;opt&#x2F;rh&#x2F;devtoolset-9&#x2F;enable&quot; &gt;&gt;&#x2F;etc&#x2F;profile</code></pre>\n\n<p>此时再查看 gcc 版本。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ gcc -v\ngcc version 9.3.1 20200408 (Red Hat 9.3.1-2) (GCC)</code></pre>\n\n<h2 id=\"查看从-SCL-源中安装的软件包\"><a href=\"#查看从-SCL-源中安装的软件包\" class=\"headerlink\" title=\"查看从 SCL 源中安装的软件包\"></a>查看从 SCL 源中安装的软件包</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ scl -l\ndevtoolset-9</code></pre>\n","text":"Centos7 gcc 版本默认 4.8.5，而有些软件（例如：Redis6、Mariadb10 等）的编译安装需要最低支持 c++11 的 gcc 5.x 版本。我们在需要升级 gcc 的版本。但是 Red Hat 为了软件的稳定和版本支持，yum 上版本也是 4.8.5，所以...","link":"","photos":[],"count_time":{"symbolsCount":"7.4k","symbolsTime":"7 mins."},"categories":[{"name":"CentOS","slug":"CentOS","count":4,"path":"api/categories/CentOS.json"}],"tags":[{"name":"CentOS","slug":"CentOS","count":4,"path":"api/tags/CentOS.json"},{"name":"gcc","slug":"gcc","count":1,"path":"api/tags/gcc.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85-SCL-%E6%BA%90\"><span class=\"toc-text\">安装 SCL 源</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9B%B4%E6%8D%A2%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F%E6%BA%90\"><span class=\"toc-text\">更换国内镜像源</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9B%B4%E6%96%B0%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%BC%93%E5%AD%98\"><span class=\"toc-text\">更新软件包缓存</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9F%A5%E7%9C%8B%E6%BA%90%E4%B8%AD%E5%85%B3%E4%BA%8E-devtoolset-gcc-%E7%9A%84%E8%BD%AF%E4%BB%B6%E5%8C%85\"><span class=\"toc-text\">查看源中关于 devtoolset-gcc 的软件包</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E5%8C%85\"><span class=\"toc-text\">安装软件包</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%87%E6%8D%A2-gcc-%E7%89%88%E6%9C%AC\"><span class=\"toc-text\">切换 gcc 版本</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9F%A5%E7%9C%8B%E4%BB%8E-SCL-%E6%BA%90%E4%B8%AD%E5%AE%89%E8%A3%85%E7%9A%84%E8%BD%AF%E4%BB%B6%E5%8C%85\"><span class=\"toc-text\">查看从 SCL 源中安装的软件包</span></a></li></ol>","author":{"name":"JaimeZeng","slug":"blog-author","avatar":"https://cdn.staticaly.com/gh/JaimeZeng/cdn/main/blog/avatar.png","link":"/","description":"Stay Simple.","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"github":"https://github.com/JaimeZeng"}}},"mapped":true,"prev_post":{"title":"Git 工作流","uid":"4ed00788422e64ad67195cd4951f38dd","slug":"2020-09-05-Git-工作流","date":"2020-09-18T10:35:43.000Z","updated":"2021-09-02T13:46:03.511Z","comments":true,"path":"api/articles/2020-09-05-Git-工作流.json","keywords":null,"cover":[],"text":"Git 工作流提到版本控制管理系统，很多人会第一时间才能想到 SVN 和 Git。而 SVN 和 Git 除了集中式和分布式的区别外，就是分支管理。相比 SVN，Git 提供更丰富的分支特性。 Git 工作流如下图所示： 现在让我们来看一个最简单的分支管理的例子。 开发某个网站，...","link":"","photos":[],"count_time":{"symbolsCount":"4.8k","symbolsTime":"4 mins."},"categories":[{"name":"Git","slug":"Git","count":1,"path":"api/categories/Git.json"}],"tags":[{"name":"Git","slug":"Git","count":1,"path":"api/tags/Git.json"}],"author":{"name":"JaimeZeng","slug":"blog-author","avatar":"https://cdn.staticaly.com/gh/JaimeZeng/cdn/main/blog/avatar.png","link":"/","description":"Stay Simple.","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"github":"https://github.com/JaimeZeng"}}}},"next_post":{"title":"WordPress 简体中文版下载","uid":"3d9606322b01991a3969128bbbc840a2","slug":"2020-04-10 WordPress 简体中文版下载","date":"2020-04-10T13:23:43.000Z","updated":"2021-09-02T13:46:03.511Z","comments":true,"path":"api/articles/2020-04-10 WordPress 简体中文版下载.json","keywords":null,"cover":[],"text":" 因为 WordPress 的服务器都在国外，所以中国大陆的用户在访问由 WordPress 官方提供的服务时总是很缓慢。近期又因为被攻击的原因，WordPress 的 CDN 提供商屏蔽了中国大陆的流量，导致大陆用户访问插件主题商城等服务时报 429 错误。 WordPress...","link":"","photos":[],"count_time":{"symbolsCount":"2.3k","symbolsTime":"2 mins."},"categories":[{"name":"WordPress","slug":"WordPress","count":3,"path":"api/categories/WordPress.json"}],"tags":[{"name":"WordPress","slug":"WordPress","count":3,"path":"api/tags/WordPress.json"}],"author":{"name":"JaimeZeng","slug":"blog-author","avatar":"https://cdn.staticaly.com/gh/JaimeZeng/cdn/main/blog/avatar.png","link":"/","description":"Stay Simple.","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"github":"https://github.com/JaimeZeng"}}}}}